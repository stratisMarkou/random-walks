---
interact_link: content/gaussian-processes/sparse/vfe.ipynb
kernel_name: venv-random-walks
kernel_path: content/gaussian-processes/sparse
has_widgets: false
title: |-
  VFE
pagenum: 4
prev_page:
  url: /gaussian-processes/sparse/fitc.html
next_page:
  url: /guide/01_overview.html
suffix: .ipynb
search: mathbf x f bar y q p fb lrb def theta k align neq left right xb boldsymbol log frac int bs begin end fx cancel choose special approximate posterior mathcal free energy bound df d kxx kxb kbx kbb bm vfe maximize kl divergence elbo note form maximise w r t text argmax solve maximising substitute prior require substituting n observations tightness expressiveness different things

comment: "***PROGRAMMATICALLY GENERATED, DO NOT EDIT. SEE ORIGINAL FILES IN /content***"
---

    <main class="jupyter-page">
    <div id="page-info"><div id="page-title">VFE</div>
</div>
    <div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Maximize KL divergence ELBO:</p>
\begin{align}
\mathbf{F}(q, \boldsymbol{\theta}) &amp;= \log p(\mathbf{y} | \boldsymbol{\theta}) + \int q(f | \mathbf{y}) \log \frac{p(f | \mathbf{y})}{q(f | \mathbf{y})}\\
&amp;= \int q(f | \mathbf{y}) \log \frac{p(\mathbf{y}, f | \boldsymbol{\theta})}{q(f | \mathbf{y})}
\end{align}<p>Note that we can choose the form of $q(f | \mathbf{y})$ as we like. Choose a special approximate posterior:</p>
\begin{align}
q(f | \mathbf{y}) = p\left(f_{\neq \mathbf{\bar{X}}} | \mathbf{f}_{\mathbf{\bar{X}}}\right) q\left(\mathbf{f}_{\mathbf{\bar{X}}} | \mathbf{y} \right)
\end{align}<p>Maximise $\mathcal{F}$ w.r.t. $q$:</p>
\begin{align}
q^*\left(\mathbf{f}_{\mathbf{\bar{X}}} | \mathbf{y} \right) = \text{argmax}_{q} \mathbf{F}(q, \boldsymbol{\theta})
\end{align}<h2 id="Solve-for-maximising-the-free-energy">Solve for maximising the free energy<a class="anchor-link" href="#Solve-for-maximising-the-free-energy"> </a></h2><p>Substitute special prior in free energy bound:</p>
\begin{align} \require{cancel}
\mathbf{F}(q, \boldsymbol{\theta}) &amp;= \int p\lrb[f_{\neq \Xb} | \fb] q\lrb[\fb | \mathbf{y}] \log \frac{p(\mathbf{y}, f | \bs[\theta])}{p\lrb[f_{\neq \Xb} | \fb] q\lrb[\mathbf{f}_{\mathbf{\bar{X}}} | \mathbf{y}]} df\\
&amp;= \int p\lrb[f_{\neq \Xb} | \fb] q\lrb[\fb | \mathbf{y}] \log \frac{p(\mathbf{y} | \mathbf{f}, \bs[\theta])  \cancel{p\lrb[f_{\neq \Xb} | fb]}  p\lrb[\fb]}{\cancel{p\lrb[f_{\neq \Xb} | \fb]} q\left(\fb | \mathbf{y} \right)} df\\
&amp;= \int p\lrb[\fx | \fb] q\lrb[\fb | \mathbf{y}] \log \frac{p(\mathbf{y} | \mathbf{f}, \bs[\theta]) p(\fb)}{ q\lrb[\fb | \mathbf{y}]} d\fx d\fb
\end{align}<p>Substituting $p\left(f_{\neq \mathbf{\bar{X}}} | \mathbf{f}_{\mathbf{\bar{X}}}\right) = \mathcal{N}\left(f_{\neq \mathbf{\bar{X}}}; \mathbf{K}_{\mathbf{X}\mathbf{\bar{X}}} \mathbf{K}_{\mathbf{\bar{X}}\mathbf{\bar{X}}}^{-1},  \mathbf{K}_{\mathbf{\bar{X}}\mathbf{\bar{X}}} - \mathbf{K}_{\mathbf{X}\mathbf{\bar{X}}} \mathbf{K}_{\mathbf{\bar{X}}\mathbf{\bar{X}}}^{-1} \right)$</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Observations">Observations<a class="anchor-link" href="#Observations"> </a></h2><p>Tightness of bound and expressiveness of approximate posterior are different things.</p>
<p>$
 \def\Kxx{\mathbf{K}_{\mathbf{X}\mathbf{X}}}
 \def\Kxb{\mathbf{K}_{\mathbf{X}\mathbf{\bar{X}}}}
 \def\Kbx{\mathbf{K}_{\mathbf{\bar{X}}\mathbf{X}}}
 \def\Kbb{\mathbf{K}_{\mathbf{\bar{X}}\mathbf{\bar{X}}}}
 \def\fx{\mathbf{f}_{\mathbf{X}}}
 \def\fb{\mathbf{f}_{\mathbf{\bar{X}}}}
 \def\X{\mathbf{X}}
 \def\Xb{\mathbf{\bar{X}}}
 \def\lrb[#1]{\left(#1\right)}
 \def\bm[#1]{\mathbf{#1}}
 \def\bs[#1]{\boldsymbol{#1}}
$</p>
<p>$\Kxx, \Kxb, \Kbx, \Kbb, \fx, \fb, \X, \Xb, \lrb[\frac{1}{2}], \bm[1], \bs[\theta]$</p>

</div>
</div>
</div>
</div>

 


    </main>
    